<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MauiMedicalApp.ViewModels"
             x:Class="MauiMedicalApp.Pages.SmokingRecordPage"
             Title="ä»Šæ—¥æŠ½è¸">

    <ContentPage.BindingContext>
        <vm:SmokingRecordViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="24">

            <Border StrokeShape="RoundRectangle 24" BackgroundColor="#5856D6" Padding="20" StrokeThickness="0">
                <VerticalStackLayout Spacing="5" HorizontalOptions="Center">
                    <Label Text="ç›®å‰æˆ’è¸çŽå‹µ" TextColor="#CCCCFF" FontSize="14" HorizontalOptions="Center"/>
                    <Label Text="{Binding SavedMoneyText}" TextColor="White" FontSize="36" FontAttributes="Bold" HorizontalOptions="Center"/>
                    <Label Text="{Binding CleanTimeText}" TextColor="White" Opacity="0.8" FontSize="12" HorizontalOptions="Center"/>
                </VerticalStackLayout>
            </Border>

            <Border StrokeShape="RoundRectangle 24" BackgroundColor="White" Padding="30" StrokeThickness="0">
                <VerticalStackLayout Spacing="20">
                    <Label Text="è‚ºéƒ¨ç´”æ·¨æ¨¡æ“¬" FontAttributes="Bold" HorizontalOptions="Center" FontSize="16"/>

                    <Grid HeightRequest="180" WidthRequest="180" HorizontalOptions="Center">
                        <Ellipse x:Name="BreathBubble"
                                 Fill="{Binding LungBubbleColor}" 
                                 HeightRequest="140" WidthRequest="140"
                                 HorizontalOptions="Center" VerticalOptions="Center"
                                 Opacity="0.7" />

                        <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center">
                            <Label Text="{Binding LungHealthProgress, StringFormat='{0:P0}'}" 
                                   FontSize="32" FontAttributes="Bold" TextColor="#3A3A3C" HorizontalOptions="Center"/>
                            <Label Text="ç´”æ·¨åº¦" FontSize="10" TextColor="#8E8E93" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Grid>

                    <Label Text="{Binding LungStatusText}" TextColor="{Binding LungStatusColor}" 
                           FontAttributes="Bold" HorizontalOptions="Center" FontSize="18"/>
                </VerticalStackLayout>
            </Border>
            <Border StrokeShape="RoundRectangle 16" BackgroundColor="White" Padding="0" Margin="0,10,0,20" StrokeThickness="1" Stroke="#E5E5EA">

                <Button Text="æŸ¥çœ‹å®Œæ•´å¥åº·è¶¨å‹¢èˆ‡æ­·å²æ˜Žç´° âž”"
                    Command="{Binding GoSmokingChartCommand}"
                    BackgroundColor="Transparent"
                    TextColor="#5856D6"
                    FontSize="15"
                    FontAttributes="Bold"
                    HeightRequest="60" />   
            </Border>

            <Grid ColumnDefinitions="*, *" ColumnSpacing="15">
                <Button Grid.Column="0" Text="ðŸ§˜ æˆ‘å¿ä½äº†" 
                        Command="{Binding ResistCommand}"
                        BackgroundColor="#34C759" CornerRadius="15" HeightRequest="80" FontAttributes="Bold"/>

                <Button Grid.Column="1" Text="ðŸš¬ æŠ½äº†ä¸€æ”¯" 
                        Command="{Binding SmokeCommand}"
                        BackgroundColor="#E5E5EA" TextColor="#FF3B30" CornerRadius="15" HeightRequest="80" FontAttributes="Bold"/>
            </Grid>

            <Label Text="{Binding MotivationQuote}" 
                   TextColor="#8E8E93" HorizontalTextAlignment="Center" FontSize="13" LineHeight="1.4"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
